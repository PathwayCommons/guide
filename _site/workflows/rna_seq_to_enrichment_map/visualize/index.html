<!DOCTYPE html>

<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Visualize &middot; Pathway Guide
    
  </title>

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/guide/public/media/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/guide/public/media/favicons/favicon-16x16.png">
  <meta name="theme-color" content="#ffffff">

  <!-- Third-party CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> -->

  <!-- CSS -->
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/guide/public/css/main.css">

  <!-- Javascript -->
  <!-- Third-party javascript -->
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
   -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>

  <script type="text/javascript" src="/guide/public/js/deps.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } });
  </script>
  <!-- Custom javascript -->
  <script type="text/javascript" src="/guide/public/js/babel-compiled.js" defer></script>
  
</head>


  <body class="theme-base-01">
    <a name="top"></a>
    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
    <div class="masthead">
  <div class="container">
    <div class="media">
      <a class="masthead-brand" href="http://www.pathwaycommons.org/">
        <img class="mr-3" src="/guide/public/media/icons/pc_logo_dark.svg" alt="Pathway Commons">
      </a>
      <div class="media-body">
        <h1 class="masthead-title">
          <a href="/guide/" title="Home">Pathway Guide</a>
        </h1>
        <a class="masthead-author" href="http://www.pathwaycommons.org/">
            Pathway Commons
        </a>
      </div>
    </div>
  </div>
</div>

      <div class="container content">
        <div id='ajax-spinner'><img src="/guide/public/media/spinner.gif"/></div>
        <div class="page">
    

  
    
    
    
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
      
        
        

        <!-- 1st part is the root  -->
          <li class="breadcrumb-item"><a href="/guide/">Guide</a></li>
        
      
        
        

        <!-- If its a collection it is an index page  -->
          
            <li class="breadcrumb-item"><a href="/guide/workflows/archive/">Workflows</a></li>
          
        
      
        
        

        
          <li class="breadcrumb-item"><a href="/guide/workflows/rna_seq_to_enrichment_map/">Rna seq to enrichment map</a></li>
        
      
        
        

        <!-- If its the second last path  -->
          <li class="breadcrumb-item active">Visualize</li>
          
      </ol>
    </nav>
  


  

  <h1>Visualize</h1>
  <hr />

<ul>
  <li class="list-unstyled">Table of Contents
    <ul>
      <li class="list-unstyled"><a href="#goals">I. Goals</a></li>
      <li class="list-unstyled"><a href="#background">II. Background</a></li>
      <li class="list-unstyled"><a href="#workflow_step">III. Workflow Step</a></li>
      <li class="list-unstyled"><a href="#interpretation">IV. Interpretation</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="i-goals"><a href="#goals" name="goals">I. Goals</a></h2>

<p>Previously, we passed a rank list of differentially expressed genes between platelets of healthy donors and breast cancer patients along with a gene set database to the Gene Set Enrichment Analysis (GSEA) software in hopes of identifying significantly altered pathways. We could have simply ended there and examined our GSEA reports for those pathways in the list that peaked our scientific interest. In many instances, however, the results of GSEA are voluminous in part because of a high degree of redundancy amongst pathways. Can we reduce this redundancy and provide a more meaningful, interactive means to reason over the results?</p>

<p>In this workflow step, we describe Enrichment Map (EM), a visual tool that simplifies the display of a list of gene sets with a large degree of redundancy. By then end of this discussion you should:</p>

<ol>
  <li>Understand how an Enrichment Map can simplify enrichment results</li>
  <li>Learn how to create and tune an Enrichment Map</li>
  <li>Be able to generate a figure describing the landscape of altered pathways</li>
</ol>

<h2 id="ii-background"><a href="#background" name="background">II. Background</a></h2>

<p>EM was originally described by Merico <em>et al.</em> (Merico 2010) as an aid in the interpretation of gene sets emerging from enrichment analyses. The motivation for this tool is the growing number of gene sets and gene annotation detail being made available, which leads to large numbers of gene sets emerging from enrichment analyses. Even with stringent criteria, it is not uncommon for analyses to generate hundreds or thousands of pathways, making results difficult to interpret on whole. To illustrate the value of EM, let us return to our analysis of alterations in pathways of platelets by Best <em>et al.</em>.</p>

<h3 id="a-long-list-of-pathways">A long list of pathways</h3>

<p>We used GSEA to distill gene sets enriched in the underlying differences in RNA abundance between platelets from healthy donors (HD) and individuals diagnosed with breast cancer (BrCa). Our rationale for applying enrichment analysis was that we would much rather reason at the pathway-level than the gene-level. Figure 1 shows a section of the GSEA report and Table 1 shows an excerpt of the actual enrichment report for BrCa.</p>

<p><img src="figure_visualize_gsea_report.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 1. GSEA report for BrCa and HD phenotypes.</strong>
    </p>
  </div>
</div>

<p><strong>Table 1. Enrichment report for BrCa (na_pos phenotype)</strong></p>

<table class="table">
  <thead>
    <tr>
      <th style="text-align: left">NAME</th>
      <th style="text-align: center">SIZE</th>
      <th style="text-align: center">ES</th>
      <th style="text-align: center">NES</th>
      <th style="text-align: center">NOM p-val</th>
      <th style="text-align: center">FDR q-val</th>
      <th style="text-align: center">FWER p-val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">PID_FAK_PATHWAY</td>
      <td style="text-align: center">48</td>
      <td style="text-align: center">0.8144367</td>
      <td style="text-align: center">2.2033582</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
    </tr>
    <tr>
      <td style="text-align: left">THROMBOXANE A2 RECEPTOR SIGNALING</td>
      <td style="text-align: center">39</td>
      <td style="text-align: center">0.84532094</td>
      <td style="text-align: center">2.175933</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
    </tr>
    <tr>
      <td style="text-align: left">SIGNALING EVENTS MEDIATED BY FOCAL ADHESION KINASE</td>
      <td style="text-align: center">48</td>
      <td style="text-align: center">0.8144367</td>
      <td style="text-align: center">2.16101</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
    </tr>
    <tr>
      <td style="text-align: left">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
    </tr>
    <tr>
      <td style="text-align: left">IL5%NETPATH%IL5	IL5</td>
      <td style="text-align: center">49</td>
      <td style="text-align: center">0.7718686</td>
      <td style="text-align: center">2.0658088</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">0.0</td>
    </tr>
    <tr>
      <td style="text-align: left">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
      <td style="text-align: center">…</td>
    </tr>
  </tbody>
</table>

<p>Notice that even under fairly stringent criteria (i.e. p-value &lt; 1%), there are a still 578 gene sets that are deemed significantly enriched in BrCa platelets and 394 in HD. Furthermore, our GSEA report declares that 8 191 genes were used as input in our ranked list. Have we simply kicked the can down the road and traded a long list of ~8 200 genes for a long list of ~1 000 gene sets?</p>

<h3 id="data-reduction">Data reduction</h3>

<p>Ideally, we want a simple way to reduce the size of the data from an enrichment analysis while retaining, to the best of our ability, the amount of meaningful <em>information</em>. To this end, many approaches have set their sights on reducing the amount of <em>redundancy</em> amongst gene sets.</p>

<h4 id="hierachical">Hierachical</h4>

<p>Many enrichment analyses use the <a href="http://geneontology.org/" target="_blank">Gene Ontology</a> (Ashburner 2000) which is hierarchically organized. In this case, redundancy can be reduced by merging gene sets that are children of a parent cluster with broader scope. These and other similar approaches rely on variations of the same statistical test for enrichment. Importantly, these approaches do not apply to gene sets without a clearly defined hierarchy, for example, transcriptional regulator target genes. What we desire is a versatile method able to manage non-hierarchical gene sets that emerge from analysis methods, regardless of nature of the underlying enrichment test used (Khatri 2012).</p>

<h3 id="enrichment-map">Enrichment Map</h3>

<p>EM is a visualization analysis tool that organizes gene sets into an information-rich similarity network. The true power of Enrichment Map is that it is a visual display method that reduces complexity by grouping similar gene sets as defined by the number of overlapping genes. These clusters can then be annotated with a representative label gleaned from the characteristics of the individual gene sets (Figure 2).</p>

<p>Gene sets are represented as nodes whose radius is proportional to the number of genes. Edges indicate nodes with shared genes, where the thickness of the line is proportional to the degree of overlap. Finally, EM can use node color to represent other dimensions of the data, for example, gene sets enriched in different classes.</p>

<p><img src="figure_visualize_em_rationale.jpg" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 2. Rationale of the Enrichment Map.</strong> Genes within gene sets or pathways can overlap and often describe nearly identical biological concepts. An Enrichment Map reduces the redundancy in gene sets by creating a graph where nodes are gene sets, node size correlates with gene set size, and edge widths indicate the number of shared genes. Note that gene set 'd' does not share any genes with the others. Highly similar gene sets can be labelled with a single, over-arching label.
    </p>
  </div>
</div>

<p>The approach is modular in that it is compatible with any statistical test or gene set source. Enrichment Map shines when dealing with a collection of gene sets with a large degree of redundancy.</p>

<h3 id="preview-of-em-software">Preview of EM software</h3>

<p>Figure 3 provides a tour of the <a href="http://apps.cytoscape.org/apps/enrichmentmap" target="_blank">EM app</a> in the <a href="http://www.cytoscape.org/" target="_blank">Cytoscape</a> software.</p>

<p><img src="figure_visualize_em_preview.png" alt="img" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 3. Tour of the Enrichment Map app.</strong> The Enrichment Map app is accessed through Cytoscape. (A) The main window displays the gene sets (circles) and their similarity (edges). Gene set size is proportional to node radius and overlap is indicated by edge thickness. Gene sets associated with BrCa and HD classes are shaded red and blue, respectively. (B) A <code>Control Panel</code> is where settings for Cytoscape and each app appear. (C) The <code>Table Panel</code> displays data for each node and edge along with expression heatmaps. <a href="figure_visualize_em_preview.png" target="_blank">Open in new window</a>
    </p>
  </div>
</div>

<p>It should be immediately apparent from Figure 3 that the Enrichment Map app provides several helpful features including viewing underlying gene expression, grouping similar gene sets and classes/phenotypes differentiated by color.</p>

<h2 id="iii-workflow-step"><a href="#workflow_step" name="workflow_step">III. Workflow Step</a></h2>

<p>Below, we describe the process of loading our file dependencies from previous workflow steps (i.e. enrichment reports, expression, phenotypes, ranks) into the Cytoscape desktop software towards generating an Enrichment Map similar to Figure 3. We will then provide some tips on how to navigate, tune and interpret the EM in an effort to facilitate new scientific insight.</p>

<h4 id="software-requirements">Software requirements</h4>

<ul>
  <li>Install <a href="http://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html" target="_blank">Java version 8</a></li>
  <li><a href="http://www.cytoscape.org/" target="_blank">Cytoscape</a>: version 3 or higher
    <ul>
      <li>Cytoscape is an indispensable tool for network visualization and analysis. The desktop software comes as a base installation and additional capabilities are added in the form of a large ecosystem of plugins or <a href="http://apps.cytoscape.org/" target="_blank">apps</a>. Checkout the <a href="http://manual.cytoscape.org/en/stable/index.html" target="_blank">Cytoscape User Manual</a> for full description of function and capabilities.</li>
    </ul>
  </li>
  <li>Cytoscape apps
    <ul>
      <li><a href="http://apps.cytoscape.org/apps/enrichmentmap" target="_blank">Enrichment Map</a>: version 3.1.0</li>
      <li><a href="http://apps.cytoscape.org/apps/clustermaker2" target="_blank">ClusterMaker2</a>: version 1.2.1</li>
      <li><a href="http://apps.cytoscape.org/apps/wordcloud" target="_blank">WordCloud</a>: version 3.1.1</li>
      <li><a href="http://apps.cytoscape.org/apps/autoannotate" target="_blank">AutoAnnotate</a>: version 1.2</li>
    </ul>
  </li>
</ul>

<h5 id="loading-apps">Loading apps</h5>

<p>The base Cytoscape installation will use a collection of apps to generate the Enrichment Map. Apps are loaded into Cytoscape using the built-in App Manager.</p>

<p>From the Cytoscape menu bar, select <code class="highlighter-rouge">'Apps' --&gt; 'App Manager'</code> to bring up an app search panel (Figure 4).</p>

<p><img src="figure_visualize_cytoscape_apps_em.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 4. Cytoscape App Manager screen.</strong> Search for the app of choice using the <code>Install Apps</code> tab. <a href="figure_visualize_cytoscape_apps_em.png" target="_blank">Open in new window</a>
    </p>
  </div>
</div>

<p>Search for the app, highlight the correct search result and click <code class="highlighter-rouge">Install</code>. If the installation was successful, you should be able to select it by name in the <code class="highlighter-rouge">Apps</code> menu bar drop-down. Also, if you bring up the <code class="highlighter-rouge">App Manager</code> you should see it as a listing under the <code class="highlighter-rouge">Currently Installed</code> tab.</p>

<hr />

<p>Launch the Enrichment Map app by selecting from the menu bar <code class="highlighter-rouge">Apps --&gt; EnrichmentMap</code> (Figure 5). This will launch the <code class="highlighter-rouge">Create Enrichment Map</code> dialog where files common to many Enrichment Maps can be loaded or the user can load files on a case-by-case basis (Figure 5, below).</p>

<p><img src="figure_visualize_em_splash.png" alt="image" />
<br />
<img src="figure_visualize_em_load.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 5. Enrichment Map screen.</strong> (Above) The <code>Create Enrichment Map</code> dialog is where we will load our data files and adjust the Enrichment Map settings. (Below) Clicking the '+' button (red box) will enable the panel on the right to 'Load data set from files' for individual Enrichment Maps. <a href="figure_visualize_em_splash.png" target="_blank">Open in new window</a>
    </p>
  </div>
</div>

<h3 id="input">Input</h3>

<p>Below we provide the dependencies that will be loaded into the Enrichment Map app through the <code class="highlighter-rouge">Create Enrichment Map</code> dialog (Figure 6). All of these files were either provided of generated in previous workflow steps.</p>

<h4 id="gmt-file">GMT File</h4>

<p><a href="/guide/" role="button" class="btn btn-secondary btn-lg btn-block" download=""> Gene Set Database (.gmt)</a></p>

<h4 id="expression">Expression</h4>

<p><a href="/guide/" role="button" class="btn btn-secondary btn-lg btn-block" download=""> Expression (.txt)</a></p>

<h4 id="enrichments">Enrichments</h4>

<p><a href="/guide/" role="button" class="btn btn-secondary btn-lg btn-block" download=""> BrCa report (.xls)</a></p>

<p><a href="/guide/" role="button" class="btn btn-secondary btn-lg btn-block" download=""> HD report (.xls)</a></p>

<h4 id="ranks">Ranks</h4>

<p><a href="/guide/" role="button" class="btn btn-secondary btn-lg btn-block" download=""> Ranks (.rnk)</a></p>

<h4 id="classes">Classes</h4>

<p><a href="/guide/" role="button" class="btn btn-secondary btn-lg btn-block" download=""> Phenotype (.cls)</a></p>

<h3 id="analysis">Analysis</h3>

<h4 id="1-load-dependencies">1. Load dependencies</h4>

<p>Having obtained the six (6) file dependencies you may now load these into the <code class="highlighter-rouge">Create Enrichment Map</code> dialog (Figure 6).</p>

<p><img src="figure_visualize_em_create.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 6. Enrichment Map file load.</strong> Shown is the <code>Create Enrichment Map</code> dialog. Load in the file dependencies for <code>Enrichments Pos/Neg</code>, <code>GMT</code>, <code>Ranks</code>, <code>Expression</code> and <code>Classes</code>.
    </p>
  </div>
</div>

<h4 id="2-configure">2. Configure</h4>

<p>In the <code class="highlighter-rouge">Create Enrichment Map</code> dialog (Figure 6), make the following adjustments to the following sections.</p>

<ul>
  <li class="list-unstyled"><strong>Number of Nodes (gene-set filtering)</strong>
    <ul>
      <li>Set <code class="highlighter-rouge">FDR q-value cutoff</code> to 0.0001.
        <ul>
          <li>This number is inversely proportional to the stringency for displaying a gene set.</li>
          <li>Smaller number – fewer nodes.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>You will be able to adjust the parameters later on in the <code class="highlighter-rouge">Control Panel</code> tab for <code class="highlighter-rouge">Enrichment Map</code></p>
</blockquote>

<h4 id="3-build">3. Build</h4>

<p>Click <code class="highlighter-rouge">Build</code> to generate the EM displayed in Figure 7.</p>

<p><img src="figure_visualize_em_output.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 7. Enrichment Map for gene sets enriched in BrCa versus HD.</strong>  Nodes coloured red are gene sets enriched in BrCa whereas blue shaded are gene sets enriched in HD. <a href="figure_visualize_em_output.png" target="_blank">Open in new window</a>.
    </p>
  </div>
</div>

<p>Take some time to examine main window displaying the network. In particular, in the lower right region of the main window there is a bird’s eye view showing the region displayed in the main view. Let us recap what we are seeing in the main view:</p>

<ul>
  <li>Node
    <ul>
      <li>Each circle represents a gene set
        <ul>
          <li>Select a node with your mouse and examine the related data in the <code class="highlighter-rouge">Table Panel</code> tab <code class="highlighter-rouge">Node Table</code></li>
        </ul>
      </li>
      <li>Size: Number of genes in the gene set</li>
      <li>Colour: Phenotype (class) assignment and enrichment (p-value)</li>
    </ul>
  </li>
  <li>Edge
    <ul>
      <li>Indicate related gene sets as measured by shared genes
        <ul>
          <li>Select an edge with your mouse and examine the related data in the <code class="highlighter-rouge">Table Panel</code> tab <code class="highlighter-rouge">Edge Table</code></li>
        </ul>
      </li>
      <li>Thickness: Number of genes shared between gene sets</li>
    </ul>
  </li>
</ul>

<p>The <code class="highlighter-rouge">Control Panel</code> tab for <code class="highlighter-rouge">Enrichment Map</code> shows our currently selected parameters.</p>

<ul>
  <li class="list-unstyled"><strong>Control Panel</strong>
    <ul>
      <li>Increase or decrease the stringency for displaying nodes (<code class="highlighter-rouge">Node Cutoff</code>) and edges (<code class="highlighter-rouge">Edge Cutoff (Similarity)</code>) using the sliders. For instance, one can restrict the displayed gene sets to those with very low chance of being a false positive.</li>
    </ul>
  </li>
  <li class="list-unstyled"><strong>Table Panel</strong>
    <ul>
      <li>If you activate the <code class="highlighter-rouge">Heat Map</code> tab as in Figure 7, you will see a depiction of the normalized gene expression values and the samples colored by class. If you click on the <code class="highlighter-rouge">Node Table</code> (Figure 8) it should display the information summarized in the graph but displayed in tabular form. Note that if a node in the graph is selected or if there is a search match, only those results will be shown. Click anywhere on the map outside of a node to see the full results.</li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>You can search the Enrichment Map by keyword using the input text box located at the top-right. For example, searching for ‘IL5%NETPATH%IL5’ highlights the corresponding node in yellow and selects it so you can immediately view data in the <code class="highlighter-rouge">Table Panel</code>.</p>
</blockquote>

<p><img src="figure_visualize_em_table_panel.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 8. Table Panel.</strong> This panel displays tabular information for gene sets. Highlighted is the IL-5 signal transduction pathway from NetPath. <a href="figure_visualize_em_table_panel.png" target="_blank">Open in new window</a>.
    </p>
  </div>
</div>

<h3 id="output">Output</h3>

<p>It is very easy to get overwhelmed by the amount of options, settings and visual information in an Enrichment Map (Figure 7) so now is a good time to pause to reflect back upon our goal: To reduce the complexity in our long list of enriched gene sets from GSEA while maintaining as much useful information. To this end, note the presence of gene set ‘clusters’ as indicated by a very dense group of edges connecting nodes (e.g. Figure 7, top-left in blue). These are gene sets with many shared genes that likely represent very similar processes. Our aim will be to display such clusters as a single node and annotate it with one label that reflects the overarching theme of its constituents (Figure 9).</p>

<p><img src="figure_visualize_em_collapse.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 9. Preview of Enrichment Map clustering and annotation.</strong> On the left, a schematic of an Enrichment Map shows gene sets enriched in two phenotypes (red and blue). Clusters of gene sets will be identified by the Cytoscape app 'Autoannotate' which in turn, will use the 'WordCloud' app to derive a descriptive label for the cluster ('Theme One' and 'Theme Two'). The labels are extracted from the individual metadata associated with the gene sets. Finally, the clusters will be collapsed into single nodes to simplify the view.
    </p>
  </div>
</div>

<h4 id="label-clusters-of-similar-gene-sets">Label clusters of similar gene sets</h4>

<p>Clusters within the Enrichment Map represent similar biological processes and themes. In order to better summarize the Enrichment map we want to be able to annotate each of these clusters with the main theme associated with it. To do this we use the <a href="http://apps.cytoscape.org/apps/autoannotate" target="_blank">AutoAnnotate</a> app to help us summarize the network and its themes. AutoAnnotate first clusters the network and then uses <a href="http://apps.cytoscape.org/apps/wordcloud" target="_blank">WordCloud</a> to calculate the most frequent words present in each cluster node labels in efforts to highlight commonalities between the nodes in the cluster.</p>

<p><strong>i. Separating gene sets in each class</strong></p>

<p>In the main window graph, let us spatially separate the gene sets enriched in each class so that when we go to add labels, they are readily distinguishable.</p>

<p>We will select the BrCa group in red and drag the entire group over to the right separate it from the HD group in blue. To do this, Highlight the class by creating a column filter for nodes with a positive NES:</p>

<ul>
  <li><code class="highlighter-rouge">Control Panel</code> tab for <code class="highlighter-rouge">Select</code>
    <ul>
      <li>Click <code class="highlighter-rouge">+</code> to add a filter
        <ul>
          <li>Select <code class="highlighter-rouge">Column Filter</code> from the drop-down</li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">Choose column....</code> drop-down
        <ul>
          <li>Select <code class="highlighter-rouge">Node:EM1_NES (tep_brca_vs_hd)</code></li>
          <li>Enter range to include only positive values</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>Figure 10 shows the selected nodes in yellow representing the gene sets enriched in BrCa. Drag the entire group to the right of the unselected gene sets.</p>

<p><img src="figure_visualize_em_cluster_filter.png" alt="image" /></p>
<div class="card bg-light">
    <div class="card-body">
      <p class="card-text">
        <strong>Figure 10. Separating gene sets enriched in each class.</strong> The enriched gene sets in the BrCa class was selected by creating a column filter in the <code>Control Panel</code> tab <code>Select</code> for NES above 0. <a href="figure_visualize_em_cluster_filter.png" target="_blank">Open in new window</a>.
      </p>
    </div>
  </div>

<p><strong>ii. AutoAnnotate groups</strong></p>

<p>AutoAnnotate first clusters the network and then uses WordCloud to calculate the most frequent words present in each cluster’s node labels (Figure 10). Launch the dialog by clicking from the toolbar <code class="highlighter-rouge">Apps -&gt; AutoAnnotate -&gt; New Annotation Set...</code></p>

<p>In the <code class="highlighter-rouge">Quick Start</code> tab, click <code class="highlighter-rouge">Create Annotations</code> to start the annotation process. You should see clusters forming and being annotated in the main window (Figure 11).</p>

<p><img src="figure_visualize_em_cluster_autoannotate.png" alt="image" /></p>

<p><img src="figure_visualize_em_cluster_autoannotate_dialog.png" alt="image" /></p>

<div class="card bg-light">
    <div class="card-body">
      <p class="card-text">
        <strong>Figure 11. AutoAnnotate network.</strong>  <strong>(Above) Sample results using Quick Start</strong>. <strong>(Below) Advanced tab.</strong> <em>Cluster algorithm:</em> Choose from the list of possible clustering algorithms supported by AutoAnnotate including Affinity Propagation, Cluster fuzzifier, Community clustering, Connected Components Clustering, MCL, and SCPS. By default this is set to MCL. <em>Edge weight column:</em> Any numeric edge attribute column can be used as weights in the clustering algorithm. By default this is set to EM_similarity_coeffecient which is a measure of how many genes two nodes have in common. The more genes two nodes have in common the higher the value and therefore the more likely they are to be found in the same cluster. <strong>Label Options</strong> <em>Label column:</em> Select the column you would like to use to compute the labels for each cluster. By default this is set to the Enrichement Map gene set description column (EM_GS_DESCR) but any string or list of strings can be used to annotate the clusters. <a href="figure_visualize_em_cluster_autoannotate.png" target="_blank">Open in new window</a>.
      </p>
  </div>
</div>

<p><strong>iii. Collapse groups</strong></p>

<p>Figure 11 shows a pretty busy picture; It is natural to gravitate towards large clusters that appear in the enrichment results, however, in this case, size does not indicate importance or strength but rather the amount of database annotation there exist for a particular pathway or process. Single nodes represent processes that are less well known but no less important than the large clusters. In order to remove the bias introduced by redundant pathway annotations it is good to collapse the network, i.e. create a single group node for every cluster whose name is summary annotation calculated for it, in order to more easily see the overall themes present in the enrichment results (Figure 12).</p>

<ul>
  <li><code class="highlighter-rouge">Control Panel</code> select the <code class="highlighter-rouge">AutoAnnotate</code> tab
    <ul>
      <li>Click the menu drop-down (button with 3 lines)</li>
      <li>Select <code class="highlighter-rouge">Collapse All</code></li>
    </ul>
  </li>
</ul>

<p><img src="figure_visualize_em_cluster_collapsed.png" alt="image" /></p>
<div class="card bg-light">
    <div class="card-body">
      <p class="card-text">
        <strong>Figure 12. Results of collapsing AutoAnnotate.</strong> Note that we have changed the <a href="http://manual.cytoscape.org/en/stable/Styles.html" target="_blank">styling</a> to increase the clarity of the text labels and dragged our clusters together. <a href="figure_visualize_em_cluster_collapsed.png" target="_blank">Open in new window</a>.
      </p>
  </div>
</div>

<p><strong>iv. Expand a group</strong></p>

<p>Let’s reverse the process selectively and drill down into a particular group. Recall our running interest in the IL-5 signal transduction pathway originally curated by NetPath? Well it is hidden inside our clusters. We can recover the view for this gene set (Figure 13).</p>

<ul>
  <li><code class="highlighter-rouge">Search</code> for term <code class="highlighter-rouge">IL5</code></li>
  <li><code class="highlighter-rouge">Control Panel</code> select the <code class="highlighter-rouge">AutoAnnotate</code> tab
    <ul>
      <li>Right click the highlighted cluster</li>
      <li>Select <code class="highlighter-rouge">Expand</code></li>
    </ul>
  </li>
</ul>

<p><img src="figure_visualize_em_cluster_uncollapsed.png" alt="image" /></p>
<div class="card bg-light">
    <div class="card-body">
      <p class="card-text">
        <strong>Figure 13. Selectively expanding the network for a single cluster.</strong> <a href="figure_visualize_em_cluster_uncollapsed.png" target="_blank">Open in new window</a>.
      </p>
  </div>
</div>

<p>Our expanded cluster shows the constituent pathways that include our IL-5 gene set. The edges indicate shared genes, but to get a better idea of the overlap, let’s look at the overlap in all pairs of gene sets in table format (Figure 14).</p>

<ul>
  <li>Select the cluster
    <ul>
      <li>Hold Shift + drag mouse over nodes</li>
    </ul>
  </li>
  <li>Table Panel
    <ul>
      <li>Select <code class="highlighter-rouge">Edge Table</code> tab</li>
    </ul>
  </li>
</ul>

<p><img src="figure_visualize_em_cluster_uncollapsed_ilgroup.png" alt="image" /></p>
<div class="card bg-light">
    <div class="card-body">
      <p class="card-text">
        <strong>Figure 14. Showing gene overlap in gene set cluster .</strong> The <code>Table Panel</code> tab for <code>Edge Table</code> shows the pair-wise overlap in genes between different gene sets in the cluster  (EM1_Overlap_size, EM1_Overlap_genes). <a> href="figure_visualize_em_cluster_uncollapsed_ilgroup.png" target="_blank"&gt;Open in new window</a>.
      </p>
  </div>
</div>

<hr />

<p>Cytoscape affords the user a great deal of control over <a href="http://manual.cytoscape.org/en/stable/Styles.html" target="_blank">styles</a> and <a href="http://manual.cytoscape.org/en/stable/Navigation_and_Layout.html?highlight=layout" target="_blank">layout</a>. There is only so much that can be automated, so it will be up to you to tweak the look of the Enrichment Map to suit your needs. Please refer to the <a href="http://manual.cytoscape.org/en/stable/index.html" target="_blank">user manual</a> for full description of capabilities.</p>

<h2 id="iv-interpretation"><a href="#interpretation" name="interpretation">IV. Interpretation</a></h2>

<p>So what now? Below, we list some helpful tips to aid you in extracting value from an enrichment analysis.</p>

<h3 id="1-build-trust">1. Build trust</h3>

<p>No algorithm or statistic can replace the experience, expertise and critical eye of you the researcher. The best place to start with a completed EM is to examine it for genes, pathways and themes that would be expected <em>a priori</em>. These are unsurprising results that have either been previously reported or which one could have easily guessed before the analysis was even performed. Do the results pass the sanity test?</p>

<p>As an example, direct your attention to the cluster annotated with the label <em>‘blood coagulation platelet’</em> (Hint: Do a text search). This cluster consists of a hierarchy of three gene sets referencing increasingly specific GO terms (Figure 15):</p>

<ol>
  <li>Hemostasis <a href="http://www.ebi.ac.uk/QuickGO/GTerm?id=GO:0007599" target="_blank">GO:0007599</a></li>
  <li>Blood coagulation <a href="http://www.ebi.ac.uk/QuickGO/GTerm?id=GO:0007596" target="_blank">GO:0007596</a></li>
  <li>Platelet Activation <a href="http://www.ebi.ac.uk/QuickGO/GTerm?id=GO:0030168" target="_blank">GO:0030168</a></li>
</ol>

<p><img src="figure_visualize_em_coag.png" alt="image" /></p>

<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 15. Gene ontology relationship for gene set cluster 'blood coagulation platelet activation'.</strong> <em>Adapted from <a href="http://www.ebi.ac.uk/QuickGO/" target="_blank">QuickGO.</a></em>
    </p>
  </div>
</div>

<h3 id="2-identify-novelinteresting-groups">2. Identify novel/interesting groups</h3>

<p>This is where the rubber meets the road: The enrichment analysis and EM are evidence that helps you to bridge bodies of knowledge and make new, interesting connections. The discoveries that will nourish a steady-stream of publications and earn the envy of peers is largely up to you.</p>

<p>One simple way to get the creative juices flowing is to try and understand whether there are established connections between certain gene sets/groups and your specific biological context of interest. For example, one can ask whether there is an established connections between cytokine signaling pathways (‘IL-3’, ‘IL-5’, ‘IL-6’), platelets and malignancies.</p>

<h3 id="3-drill-down-to-gene-expression">3. Drill down to gene expression</h3>

<p>Perhaps we’ve noticed an interesting pathway not previously reported in our context. One way to build confidence in the result is to simply examine visually whether there is a contrast in expression between classes.</p>

<blockquote>
  <p>Recall that our p-values for differential gene expression do not provide any information about the magnitude of the expression differences.</p>
</blockquote>

<p>One approach to examine expression of a gene set is to focus on the ‘leading edge’ - the subset of genes that contribute to the enrichment analysis enrichment score (ES) (Figure 16).</p>

<p><img src="figure_visualize_em_interpret_leadingedge_il5.png" alt="image" /></p>
<div class="card bg-light">
  <div class="card-body">
    <p class="card-text">
      <strong>Figure 16. Leading edge analysis for IL-5 signal transduction pathway.</strong> Genes of the gene set that contribute most to the enrichment score - the 'leading edge' - are highlighted in yellow. <a href="figure_visualize_em_interpret_leadingedge_il5.png" target="_blank">Open in new window</a>.
    </p>
  </div>
</div>

  
  <hr/>
  <h2>References</h2>
  
  <div class="reference_group" data-reflist="[10802651 21085593 22383865]"></div>


</div>

      </div>
    </div>

  </body>
</html>
