species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
metadata_file,
species,
source_name,
target_name,
filelist)
knitr::kable(SummarizedExperiment::assay(brca_hd_tep_se)[1:10, c(1,2,6,7)])
library("SummarizedExperiment")
library(devtools)
devtools::install_github("jvwong/emRNASeq")
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
library("SummarizedExperiment")
library(devtools)
devtools::install_github("jvwong/emRNASeq")
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
library("SummarizedExperiment")
library(devtools)
devtools::install_github("jvwong/emRNASeq")
### ============ Declare directories =========
base_dir <- getwd()
data_dir <- file.path(base_dir, "data")
### ============  Merge data files =========
tep_rnaseq_metadata <- file.path(data_dir, "tep_rnaseq_metadata.txt")
tep_rnaseq_filelist <- c(file.path(data_dir, "MGH-BrCa-H-74_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-68_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-66_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-59_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-11_htsqct.txt"),
file.path(data_dir, "HD-5_htsqct.txt"),
file.path(data_dir, "HD-4_htsqct.txt"),
file.path(data_dir, "HD-3-1_htsqct.txt"),
file.path(data_dir, "HD-2-1_htsqct.txt"),
file.path(data_dir, "HD-1_htsqct.txt"))
tep_phenotypes <- read.table(tep_rnaseq_metadata)
knitr::kable(tep_phenotypes)
tep_phenotypes <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_phenotypes)
tep_phenotypes_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_phenotypes)
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df)
### ============ Declare directories =========
base_dir <- getwd()
data_dir <- file.path(base_dir, "data")
### ============  Data files =========
tep_rnaseq_metadata <- file.path(data_dir, "tep_rnaseq_metadata.txt")
tep_rnaseq_filelist <- c(file.path(data_dir, "MGH-BrCa-H-74_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-68_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-66_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-59_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-11_htsqct.txt"),
file.path(data_dir, "HD-5_htsqct.txt"),
file.path(data_dir, "HD-4_htsqct.txt"),
file.path(data_dir, "HD-3-1_htsqct.txt"),
file.path(data_dir, "HD-2-1_htsqct.txt"),
file.path(data_dir, "HD-1_htsqct.txt"))
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df)
### ============ Declare directories =========
base_dir <- getwd()
data_dir <- file.path(base_dir, "data")
### ============  Data files =========
tep_rnaseq_metadata <- file.path(data_dir, "tep_rnaseq_metadata.txt")
tep_rnaseq_filelist <- c(file.path(data_dir, "MGH-BrCa-H-74_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-68_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-66_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-59_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-11_htsqct.txt"),
file.path(data_dir, "HD-5_htsqct.txt"),
file.path(data_dir, "HD-4_htsqct.txt"),
file.path(data_dir, "HD-3-1_htsqct.txt"),
file.path(data_dir, "HD-2-1_htsqct.txt"),
file.path(data_dir, "HD-1_htsqct.txt"))
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='hey there')
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='hey there')
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='hey there')
### ============ Declare data paths =========
base_dir <- getwd()
data_dir <- file.path(base_dir, "data")
### ============ Data files =========
tep_rnaseq_metadata <- file.path(data_dir, "tep_rnaseq_metadata.txt")
tep_rnaseq_filelist <- c(file.path(data_dir, "MGH-BrCa-H-74_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-68_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-66_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-59_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-11_htsqct.txt"),
file.path(data_dir, "HD-5_htsqct.txt"),
file.path(data_dir, "HD-4_htsqct.txt"),
file.path(data_dir, "HD-3-1_htsqct.txt"),
file.path(data_dir, "HD-2-1_htsqct.txt"),
file.path(data_dir, "HD-1_htsqct.txt"))
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='hey there')
rnaseq_HD_1_htsqct <- read.table('HD-1_htsqct.txt')
tep_rnaseq_filelist
'HD_1_htsqct.txt' %in% tep_rnaseq_filelist
?grepl
grepl('HD_1_htsqct.txt', tep_rnaseq_filelist)
grepl('HD_1_htsqct.txt', tep_rnaseq_filelist)
tep_rnaseq_filelist
grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
log <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
log
tep_rnaseq_filelist[log]
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)])
knitr::kable(rnaseq_HD_1_htsqct, caption='Contents of HD_1_htsqct.txt RNA-Seq')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct])
knitr::kable(head(rnaseq_HD_1_htsqct), caption='Contents of HD_1_htsqct.txt RNA-Seq')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct), caption='Contents of HD_1_htsqct.txt RNA-Seq')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE, col.names=[NULL, NULL])
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE, col.names=c("",""))
knitr::kable(head(rnaseq_HD_1_htsqct), caption='Contents of HD_1_htsqct.txt RNA-Seq')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE, col.names=c(NULL,NULL))
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE, col.names=c(NULL,NULL))
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE, col.names=c("",""))
knitr::kable(head(rnaseq_HD_1_htsqct), caption='Contents of HD_1_htsqct.txt RNA-Seq')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct), caption='Contents of HD_1_htsqct.txt RNA-Seq')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct), caption='Contents of HD_1_htsqct.txt RNA-Seq',col.names=c("",""))
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct),
caption='Contents of HD_1_htsqct.txt RNA-Seq', col.names=c("",""))
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE, col.names=NULL)
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE, col.names=c("",""))
knitr::kable(head(rnaseq_HD_1_htsqct),
caption='Contents of HD_1_htsqct.txt RNA-Seq', col.names=c("",""))
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct),
caption='Contents of HD_1_htsqct.txt RNA-Seq', col.names=c("",""))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
library("SummarizedExperiment")
library(devtools)
devtools::install_github("jvwong/emRNASeq")
### ============ Declare data paths =========
base_dir <- getwd()
data_dir <- file.path(base_dir, "data")
### ============ Data files =========
tep_rnaseq_metadata <- file.path(data_dir, "tep_rnaseq_metadata.txt")
tep_rnaseq_filelist <- c(file.path(data_dir, "MGH-BrCa-H-74_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-68_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-66_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-59_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-11_htsqct.txt"),
file.path(data_dir, "HD-5_htsqct.txt"),
file.path(data_dir, "HD-4_htsqct.txt"),
file.path(data_dir, "HD-3-1_htsqct.txt"),
file.path(data_dir, "HD-2-1_htsqct.txt"),
file.path(data_dir, "HD-1_htsqct.txt"))
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='hey there')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct),
caption='Contents of HD_1_htsqct.txt RNA-Seq', col.names=c("",""))
source_name <- "ensembl_gene_id"
target_name <- "hgnc_symbol"
species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
tep_rnaseq_metadata,
species,
source_name,
target_name,
filelist)
View(tep_rnaseq_metadata_df)
source_name <- "ensembl_gene_id"
target_name <- "hgnc_symbol"
species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
tep_rnaseq_metadata_df,
species,
source_name,
target_name,
filelist)
source_name <- "ensembl_gene_id"
target_name <- "hgnc_symbol"
species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
tep_rnaseq_metadata,
species,
source_name,
target_name,
tep_rnaseq_filelist)
source_name <- "ensembl_gene_id"
target_name <- "hgnc_symbol"
species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
tep_rnaseq_metadata,
species,
source_name,
target_name,
tep_rnaseq_filelist)
SummarizedExperiment::colData(brca_hd_tep_se)
source_name <- "ensembl_gene_id"
target_name <- "hgnc_symbol"
species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
tep_rnaseq_metadata,
species,
source_name,
target_name,
tep_rnaseq_filelist)
SummarizedExperiment::colData(brca_hd_tep_se)
tep_rnaseq_metadata
tep_rnaseq_metadata
tep_rnaseq_filelist
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct),
caption='Contents of HD_1_htsqct.txt RNA-Seq', col.names=c("",""))
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='hey there')
source_name <- "ensembl_gene_id"
target_name <- "hgnc_symbol"
species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
tep_rnaseq_metadata,
species,
source_name,
target_name,
tep_rnaseq_filelist)
knitr::kable(head(SummarizedExperiment::colData(brca_hd_tep_se)))
knitr::kable(SummarizedExperiment::colData(brca_hd_tep_se))
SummarizedExperiment::colData(brca_hd_tep_se)
knitr::kable(SummarizedExperiment::rowRanges(brca_hd_tep_se))
# knitr::kable(SummarizedExperiment::rowRanges(brca_hd_tep_se))
SummarizedExperiment::rowRanges(brca_hd_tep_se)
# knitr::kable(SummarizedExperiment::rowRanges(brca_hd_tep_se))
SummarizedExperiment::rowRanges(brca_hd_tep_se)
knitr::kable(SumsmarizedExperiment::rowRanges(brca_hd_tep_se))
knitr::kable(SummarizedExperiment::rowRanges(brca_hd_tep_se))
df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
knitr::kable(df)
# SummarizedExperiment::rowRanges(brca_hd_tep_se)
?head
df <- head(as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se)))
knitr::kable(df)
# SummarizedExperiment::rowRanges(brca_hd_tep_se)
brca_hd_tep_rowRanged_df <- head(as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se)))
knitr::kable(brca_hd_tep_rowRanged_df)
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
length(brca_hd_tep_rowRanged_df)
knitr::kable(brca_hd_tep_rowRanged_df)
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
length(brca_hd_tep_rowRanged_df)
knitr::kable(head(brca_hd_tep_rowRanged_df))
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
length(brca_hd_tep_rowRanged_df)
knitr::kable(head(brca_hd_tep_rowRanged_df))
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
# length(brca_hd_tep_rowRanged_df)
knitr::kable(head(brca_hd_tep_rowRanged_df))
length(brca_hd_tep_rowRanged_df)
print(size(brca_hd_tep_rowRanged_df))
(size(brca_hd_tep_rowRanged_df))
print(dim(brca_hd_tep_rowRanged_df))
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
# length(brca_hd_tep_rowRanged_df)
knitr::kable(head(brca_hd_tep_rowRanged_df))
print(dim(brca_hd_tep_rowRanged_df))
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
# length(brca_hd_tep_rowRanged_df)
knitr::kable(head(brca_hd_tep_rowRanged_df))
(dim(brca_hd_tep_rowRanged_df))
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
# length(brca_hd_tep_rowRanged_df)
knitr::kable(head(brca_hd_tep_rowRanged_df))
dim(brca_hd_tep_rowRanged_df)
library(devtools)
library("SummarizedExperiment")
devtools::install_github("jvwong/emRNASeq")
brca_hd_tep_filtered_dge <- emRNASeq::filter_rseq(brca_hd_tep_se, "HD", "BrCa")
knitr::kable(head(brca_hd_tep_filtered_dge))
brca_hd_tep_filtered_dge <- emRNASeq::filter_rseq(brca_hd_tep_se, "HD", "BrCa")
brca_hd_tep_filtered_df <- as.data.frame(brca_hd_tep_filtered_dge)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
### ============ Declare data paths =========
base_dir <- getwd()
data_dir <- file.path(base_dir, "data")
### ============ Data files =========
tep_rnaseq_metadata <- file.path(data_dir, "tep_rnaseq_metadata.txt")
tep_rnaseq_filelist <- c(file.path(data_dir, "MGH-BrCa-H-74_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-68_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-66_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-59_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-11_htsqct.txt"),
file.path(data_dir, "HD-5_htsqct.txt"),
file.path(data_dir, "HD-4_htsqct.txt"),
file.path(data_dir, "HD-3-1_htsqct.txt"),
file.path(data_dir, "HD-2-1_htsqct.txt"),
file.path(data_dir, "HD-1_htsqct.txt"))
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='hey there')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct),
caption='Contents of HD_1_htsqct.txt RNA-Seq', col.names=c("",""))
brca_hd_tep_filtered_dge <- emRNASeq::filter_rseq(brca_hd_tep_se, "HD", "BrCa")
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
### ============ Declare data paths =========
base_dir <- getwd()
data_dir <- file.path(base_dir, "data")
### ============ Data files =========
tep_rnaseq_metadata <- file.path(data_dir, "tep_rnaseq_metadata.txt")
tep_rnaseq_filelist <- c(file.path(data_dir, "MGH-BrCa-H-74_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-68_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-66_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-59_htsqct.txt"),
file.path(data_dir, "MGH-BrCa-H-11_htsqct.txt"),
file.path(data_dir, "HD-5_htsqct.txt"),
file.path(data_dir, "HD-4_htsqct.txt"),
file.path(data_dir, "HD-3-1_htsqct.txt"),
file.path(data_dir, "HD-2-1_htsqct.txt"),
file.path(data_dir, "HD-1_htsqct.txt"))
tep_rnaseq_metadata_df <- read.table(tep_rnaseq_metadata,header = TRUE)
knitr::kable(tep_rnaseq_metadata_df, caption='Table I. Patient TEP RNA-Seq metadata (tep_rnaseq_metadata.txt)')
index_HD_1_htsqct <- grepl('HD-1_htsqct.txt', tep_rnaseq_filelist)
rnaseq_HD_1_htsqct <- read.table(tep_rnaseq_filelist[index_HD_1_htsqct],
check.names=FALSE)
knitr::kable(head(rnaseq_HD_1_htsqct),
caption='Excerpt of RNA-Seq file HD-1_htsqct.txt', col.names=c("",""))
library(devtools)
library("SummarizedExperiment")
devtools::install_github("jvwong/emRNASeq")
source_name <- "ensembl_gene_id"
target_name <- "hgnc_symbol"
species <- "human"
brca_hd_tep_se <- emRNASeq::merge_data(
tep_rnaseq_metadata,
species,
source_name,
target_name,
tep_rnaseq_filelist)
knitr::kable(SummarizedExperiment::colData(brca_hd_tep_se))
brca_hd_tep_rowRanged_df <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
knitr::kable(head(brca_hd_tep_rowRanged_df))
dim(brca_hd_tep_rowRanged_df)
knitr::kable(head(SummarizedExperiment::assay(brca_hd_tep_se))[, c(1,2,6,7)])
brca_hd_tep_filtered_dge <- emRNASeq::filter_rseq(brca_hd_tep_se, "HD", "BrCa")
brca_hd_tep_filtered_df <- as.data.frame(brca_hd_tep_filtered_dge)
brca_hd_tep_filtered_dge <- emRNASeq::filter_rseq(brca_hd_tep_se, "HD", "BrCa")
brca_hd_tep_filtered_df <- as.data.frame(brca_hd_tep_filtered_dge)
brca_hd_tep_filtered_dge
class(brca_hd_tep_filtered_dge)
dim(brca_hd_tep_filtered_dge)
head(brca_hd_tep_filtered_dge)
att(brca_hd_tep_se)
attr(brca_hd_tep_se)
brca_hd_tep_se
brca_hd_tep_se
type(brca_hd_tep_se)
typeof(brca_hd_tep_se)
class(brca_hd_tep_se)
SummarizedExperiment::assays(brca_hd_tep_se)$counts
knitr::kable(head(SummarizedExperiment::assay(brca_hd_tep_se)$counts)[, c(1,2,6,7)])
knitr::kable(head(SummarizedExperiment::assays(brca_hd_tep_se)$counts)[, c(1,2,6,7)])
library(edgeR)
baseline_class <- "HD"
test_class <- "BrCa"
comparison <- c(baseline_class, test_class)
se_counts <- SummarizedExperiment::assays(se)$counts
if(is(se, "RangedSummarizedExperiment")){
se_genes <- as.data.frame(SummarizedExperiment::rowRanges(se))
} else {
se_genes <- NULL
}
se_groups <- SummarizedExperiment::colData(se)$class
index_test <- se_groups == comparison[1]
index_test <- se_groups == comparison[1]
se_groups <- SummarizedExperiment::colData(se)$class
library(edgeR)
min_counts <- 1
baseline_class <- "HD"
test_class <- "BrCa"
comparison <- c(baseline_class, test_class)
brca_hd_tep_se_counts <- SummarizedExperiment::assays(brca_hd_tep_se)$counts
if(is(brca_hd_tep_se, "RangedSummarizedExperiment")){
brca_hd_tep_se_genes <- as.data.frame(SummarizedExperiment::rowRanges(brca_hd_tep_se))
} else {
brca_hd_tep_se_genes <- NULL
}
brca_hd_tep_se_groups <- SummarizedExperiment::colData(brca_hd_tep_se)$class
index_test_class <- brca_hd_tep_se_groups == comparison[1]
index_baseline_class <- brca_hd_tep_se_groups == comparison[2]
row_with_mincount <-
rowSums(edgeR::cpm(brca_hd_tep_se_counts) > min_counts) >= min(sum(index_baseline_class), sum(index_test_class))
index_test_class
library(edgeR)
### Minimum number of mapped read counts
min_counts <- 1
### Declare baseline (i.e. control) and test classes
### Differential expression expressed as test relative control
baseline_class <- "HD"
test_class <- "BrCa"
comparison <- c(baseline_class, test_class)
brca_hd_tep_se_counts <- SummarizedExperiment::assays(brca_hd_tep_se)$counts
### Fill in the 'group' metadata for our output edgeR::DGEList
brca_hd_tep_se_groups <- SummarizedExperiment::colData(brca_hd_tep_se)$class
index_test_class <- brca_hd_tep_se_groups == comparison[1]
index_baseline_class <- brca_hd_tep_se_groups == comparison[2]
### Find genes (rows) with a minimum number of counts
row_with_mincount <-
rowSums(edgeR::cpm(brca_hd_tep_se_counts) > min_counts) >=
min(sum(index_baseline_class), sum(index_test_class))
### Subset the original data accordingly
brca_hd_tep_dge_counts <- brca_hd_tep_se_counts[row_with_mincount,]
### Push the data into the edgeR::DGEList
brca_hd_tep_filtered_dge <-
edgeR::DGEList(counts = brca_hd_tep_dge_counts, group = brca_hd_tep_se_groups)
# brca_hd_tep_filtered_df <- as.data.frame(brca_hd_tep_filtered_dge)
# knitr::kable(head(brca_hd_tep_filtered_df))
brca_hd_tep_filtered_dge
getSlots(brca_hd_tep_filtered_dge)
getSlots(brca_hd_tep_filtered_dge, x = )
names(brca_hd_tep_filtered_dge)
?names
slotNames(brca_hd_tep_filtered_dge)
names(getSlots(brca_hd_tep_filtered_dge))
names(brca_hd_tep_filtered_dge)
brca_hd_tep_filtered_dge
brca_hd_tep_filtered_dge
knitr::kable(brca_hd_tep_filtered_dge$samples)
knitr::kable(brca_hd_tep_filtered_dge$counts)
knitr::kable(head(brca_hd_tep_filtered_dge$counts))
knitr::kable(head(brca_hd_tep_filtered_dge$counts)[, c(1,2,5,6)])
brca_hd_tep_tmm_normalized_dge <- emRNASeq::normalize_rseq(brca_hd_tep_filtered_dge)
brca_hd_tep_tmm_normalized_dge <- emRNASeq::normalize_rseq(brca_hd_tep_filtered_dge)
knitr::kable(brca_hd_tep_tmm_normalized_dge$samples)
brca_hd_tep_tmm_normalized_mat <- edgeR::cpm(brca_hd_tep_tmm_normalized_dge, normalized.lib.size=TRUE)
meta_df <- data.frame(
NAME = rownames(brca_hd_tep_tmm_normalized_mat),
DESCRIPTION = rownames(brca_hd_tep_tmm_normalized_mat),
check.names = FALSE)
rownames(brca_hd_tep_tmm_normalized_mat) <- NULL
brca_hd_tep_tmm_normalized_expression_df <- data.frame(meta_df, brca_hd_tep_tmm_normalized_mat,  check.names = FALSE)
brca_hd_tep_tmm_normalized_expression_df
dim(brca_hd_tep_tmm_normalized_expression_df)
names(brca_hd_tep_tmm_normalized_expression_df)
brca_hd_tep_tmm_normalized_dge <- emRNASeq::normalize_rseq(brca_hd_tep_filtered_dge)
knitr::kable(brca_hd_tep_tmm_normalized_dge$samples)
brca_hd_tep_tmm_normalized_mat <- edgeR::cpm(brca_hd_tep_tmm_normalized_dge, normalized.lib.size=TRUE)
meta_df <- data.frame(
NAME = rownames(brca_hd_tep_tmm_normalized_mat),
DESCRIPTION = rownames(brca_hd_tep_tmm_normalized_mat),
check.names = FALSE)
rownames(brca_hd_tep_tmm_normalized_mat) <- NULL
brca_hd_tep_tmm_normalized_expression_df <- data.frame(meta_df, brca_hd_tep_tmm_normalized_mat,  check.names = FALSE)
brca_hd_tep_tmm_normalized_mat <- edgeR::cpm(brca_hd_tep_tmm_normalized_dge, normalized.lib.size=TRUE)
meta_df <- data.frame(
NAME = rownames(brca_hd_tep_tmm_normalized_mat),
DESCRIPTION = rownames(brca_hd_tep_tmm_normalized_mat),
check.names = FALSE)
rownames(brca_hd_tep_tmm_normalized_mat) <- NULL
brca_hd_tep_tmm_normalized_expression_df <- data.frame(meta_df, brca_hd_tep_tmm_normalized_mat,  check.names = FALSE)
knitr::kable(head(brca_hd_tep_tmm_normalized_expression_df))
brca_hd_tep_tmm_normalized_mat <- edgeR::cpm(brca_hd_tep_tmm_normalized_dge, normalized.lib.size=TRUE)
meta_df <- data.frame(
NAME = rownames(brca_hd_tep_tmm_normalized_mat),
DESCRIPTION = rownames(brca_hd_tep_tmm_normalized_mat),
check.names = FALSE)
rownames(brca_hd_tep_tmm_normalized_mat) <- NULL
brca_hd_tep_tmm_normalized_expression_df <- data.frame(meta_df, brca_hd_tep_tmm_normalized_mat,  check.names = FALSE)
knitr::kable(head(brca_hd_tep_tmm_normalized_expression_df)[,c(1:4,8,9)])
brca_hd_tep_fitted_commondisp_dge <- edgeR::estimateCommonDisp(brca_hd_tep_tmm_normalized_dge)
brca_hd_tep_fitted_tagwise_dge <- edgeR::estimateTagwiseDisp(brca_hd_tep_fitted_commondisp_dge)
brca_hd_tep_de_tested_dge <- edgeR::exactTest(brca_hd_tep_fitted_tagwise_dge, pair = comparison)
brca_hd_tep_de_tested_tt <- edgeR::topTags(brca_hd_tep_de_tested_dge,
n = nrow(normalized_dge),
adjust.method = "BH",
sort.by = "PValue")
brca_hd_tep_fitted_commondisp_dge <- edgeR::estimateCommonDisp(brca_hd_tep_tmm_normalized_dge)
brca_hd_tep_fitted_tagwise_dge <- edgeR::estimateTagwiseDisp(brca_hd_tep_fitted_commondisp_dge)
brca_hd_tep_de_tested_dge <- edgeR::exactTest(brca_hd_tep_fitted_tagwise_dge, pair = comparison)
brca_hd_tep_de_tested_tt <- edgeR::topTags(brca_hd_tep_de_tested_dge,
n = nrow(brca_hd_tep_tmm_normalized_dge),
adjust.method = "BH",
sort.by = "PValue")
brca_hd_tep_de_tested_tt
names(brca_hd_tep_de_tested_tt)
